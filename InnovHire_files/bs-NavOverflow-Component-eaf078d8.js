define("@widget/LAYOUT/bs-NavOverflow-Component-eaf078d8.js",["exports","@widget/LAYOUT/c/bs-_rollupPluginBabelHelpers","@widget/LAYOUT/c/bs-dataAids","@widget/LAYOUT/c/bs-countVCTElement","@widget/LAYOUT/c/bs-Toggle","@widget/LAYOUT/c/bs-index2","@widget/LAYOUT/bs-FlyoutMenu-Component","@widget/LAYOUT/c/bs-elements","@widget/LAYOUT/c/bs-eventListenerPolyfill"],(function(e,t,i,s,o,l,a,n,r){"use strict";let d;class h extends(global.React||guac.react).Component{constructor(){super(...arguments),this.handleResize=this.handleResize.bind(this),this.throttleResize=this.throttleResize.bind(this),this.renderNavItems=this.renderNavItems.bind(this),this.renderSplitNavItems=this.renderSplitNavItems.bind(this),this.markVisuallyComplete=this.markVisuallyComplete.bind(this),this.state={isActive:!1,isVctMarked:!1}}componentDidMount(){const{renderMode:e,logoImageId:t}=this.props;if(e===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH){const e=`(function() {var n=document.querySelector('[data-aid="${i.DataAid.HEADER_NAV_RENDERED}"]');n.offsetHeight>0&&n.offsetWidth>0&&(${s.countVCTElement});}())`,t=document.createElement("script");t.appendChild(document.createTextNode(e)),document.body.appendChild(t)}if(r.eventListenerPolyfill(),this.mounted=!0,window.addEventListener("resize",this.throttleResize,{passive:!0}),window.addEventListener("CartQuantityChange",this.throttleResize,{passive:!0}),t){const e=document.getElementById(t);e&&e.addEventListener("load",this.throttleResize)}this.handleResize()}componentWillUnmount(){this.mounted=!1,window.removeEventListener("resize",this.throttleResize,{passive:!0}),window.removeEventListener("CartQuantityChange",this.throttleResize,{passive:!0})}componentDidUpdate(e){(global._||guac.lodash).isEqual(e.navigation,this.props.navigation)||this.handleResize()}resetVisibility(e){e.forEach(e=>{e.style.display="",e.style.visibility="hidden",e.classList.remove("visible"),e.classList.remove("last-visible-nav-item")})}throttleResize(){window.clearTimeout(d),d=setTimeout(this.handleResize,100)}handleResize(e=0){const{parentId:t,splitNavId:i,inlineUtilitiesMenu:s}=this.props;if(e>5||!this.mounted||"undefined"==typeof document||!t)return;const o=document.getElementById(t);if(this.items=o&&Array.prototype.slice.call(o.children),!this.items||!this.items.length)return void setTimeout(this.handleResize.bind(this,++e),1);this.resetVisibility(this.items),s&&(this.inlineUtilitiesMenu=this.items.pop(),n.show(this.inlineUtilitiesMenu)),this.more=this.items.pop();const l=this.more&&this.more.querySelector("ul");if(this.moreItems=l&&Array.prototype.slice.call(l.children),this.moreItems&&this.moreItems.length)return this.resetVisibility(this.moreItems),o&&o.style&&(o.style.whiteSpace="normal"),this.maxWidth=n.getWidth(o.parentElement,"floor"),o&&o.style&&(o.style.whiteSpace="nowrap"),i?this.renderSplitNavItems(e):this.renderNavItems();setTimeout(this.handleResize.bind(this,++e),1)}markVisuallyComplete(){if(this.props.renderMode===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH&&window&&!this.state.isVctMarked){const e=document&&document.querySelector(`[data-aid="${i.DataAid.HEADER_NAV_RENDERED}"]`);e.offsetHeight>0&&e.offsetWidth>0&&(window.markVisuallyComplete(),this.setState({isVctMarked:!0}))}}renderNavItems(){const{items:e,more:t,moreItems:i,maxWidth:s,inlineUtilitiesMenu:o}=this,l=n.getWidths(e),a=n.getWidth(t),r=s-(o?n.getWidth(o):0);let d=!1;if((global._||guac.lodash).sum(l)>r){let s=e.length-1,o=(global._||guac.lodash).sum(l);(global._||guac.lodash).forEachRight(l,e=>{o+a<r||(o-=e,s--)}),s++;for(let t=0;t<s;t++)n.show(e[t]),n.hide(i[t]);for(let t=s;t<e.length;t++)n.hide(e[t]),n.show(i[t]),e[t].querySelector('[data-ux="NavLinkActive"]')&&(d=!0);n.show(t)}else e.forEach(e=>n.show(e)),n.hide(t);d!==this.state.isActive&&this.setState({isActive:d}),this.markVisuallyComplete()}renderSplitNavItems(e=0){const{splitNavId:t}=this.props,{items:i,more:s,moreItems:o,maxWidth:a,inlineUtilitiesMenu:r}=this,d=this.inlineUtilitiesMenu&&this.inlineUtilitiesMenu.querySelector("[data-ux='Pipe']");d&&n.hide(d);const h=document.getElementById(t);this.leftItems=h&&h.children&&[].slice.call(h.children);const{leftItems:c}=this;if(!c||!c.length)return void setTimeout(this.handleResize.bind(this,++e),1);const p=c.pop(),g=n.getWidths(i);let u=0;const m=r?n.getWidth(r):0;let y=0,b=g.concat(m).findIndex(e=>{if(y+e>a)return e;y+=e});b<0&&(b=g.length);const v=g.slice(0,b),w=g.slice(b);let f=!1;for((global._||guac.lodash).forEachRight(g,()=>{(global._||guac.lodash).sum(w)+u+m<a||(w.pop(),f=!0,u=n.getWidth(s))});v.length>1&&l.isImbalanced(v,w.concat([u,m]));)w.unshift(v.pop());let I=!1;for(let e=0;e<v.length;e++)n.show(c[e]),n.hide(i[e]),n.hide(o[e]);for(let e=v.length;e<v.length+w.length;e++)n.hide(c[e]),n.show(i[e]),n.hide(o[e]);for(let e=v.length+w.length;e<i.length;e++)n.hide(c[e]),n.hide(i[e]),n.show(o[e]),(i[e].querySelector('[data-ux="NavLinkActive"]')||o[e].querySelector('[data-ux="NavMoreMenuLinkActive"]')||o[e].querySelector('[data-ux="NavMoreMenuLinkNestedActive"]'))&&(I=!0);f?n.show(s):n.hide(s),n.hide(p),I!==this.state.isActive&&this.setState({isActive:I});(r||(f?s:(global._||guac.lodash).last(i))).classList.add("last-visible-nav-item");const R=i.find(e=>"visible"===e.style.visibility);d&&R&&n.show(d),this.markVisuallyComplete()}render(){const{hideDropdown:e,staticContent:s,...o}=this.props,{isActive:l}=this.state;return(global.React||guac.react).createElement((global.React||guac.react).Fragment,null,!e&&(global.React||guac.react).createElement(a.default,t._extends({},(global._||guac.lodash).pick(o,["style","toggleId","navBarId","parentId","activeProps","label","enableNoOverlapDropdown"]),{"data-aid":i.DataAid.NAV_MORE,ignoreCloseAttr:"data-ignore-close",isActive:l,"aria-label":s.navigationDropdownToggle})))}}h.propTypes={navigation:(global.PropTypes||guac["prop-types"]).array.isRequired,parentId:(global.PropTypes||guac["prop-types"]).string.isRequired,toggleId:(global.PropTypes||guac["prop-types"]).string.isRequired,splitNavId:(global.PropTypes||guac["prop-types"]).string,activeProps:(global.PropTypes||guac["prop-types"]).object,label:(global.PropTypes||guac["prop-types"]).string.isRequired,renderMode:(global.PropTypes||guac["prop-types"]).string.isRequired,style:(global.PropTypes||guac["prop-types"]).object,enableNoOverlapDropdown:(global.PropTypes||guac["prop-types"]).bool,hideDropdown:(global.PropTypes||guac["prop-types"]).bool,inlineUtilitiesMenu:(global.PropTypes||guac["prop-types"]).bool,logoImageId:(global.PropTypes||guac["prop-types"]).string,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired},h.defaultProps={activeProps:{},staticContent:{}},e.default=h})),"undefined"!=typeof window&&(window.global=window);
